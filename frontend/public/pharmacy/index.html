<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng ƒêi·ªÅu Khi·ªÉn - Nh√† Thu·ªëc</title> <!-- Changed Title -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
</head>
<body>
    <nav class="navbar is-primary" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="#">
                <strong>H·ªá Th·ªëng Ph√¢n Ph·ªëi Thu·ªëc - Nh√† Thu·ªëc</strong> <!-- Changed Brand -->
            </a>
            
            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasic">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        
        <div id="navbarBasic" class="navbar-menu">
            <div class="navbar-start">
                 <!-- Simplified Navbar for Pharmacy -->
                <a class="navbar-item tab-link is-active" data-tab="pharmacy"> <!-- Default active tab -->
                    Qu·∫£n l√Ω nh√† thu·ªëc
                </a>
                <a class="navbar-item tab-link is-active" data-tab="pharmacy-out"> <!-- Default active tab -->
                    K√™ ƒë∆°n thu·ªëc
                </a>
                <a class="navbar-item tab-link" data-tab="medicines">
                    Qu·∫£n l√Ω thu·ªëc (Chung)
                </a>
                <a class="navbar-item tab-link" data-tab="tracking">
                    Tra c·ª©u thu·ªëc (Chung)
                </a>
                 <a class="navbar-item tab-link" data-tab="dashboard"> <!-- Kept dashboard for overview -->
                    T·ªïng quan (Chung)
                </a>
            </div>
            
            <div class="navbar-end">
                <div class="navbar-item">
                    <div class="buttons">
                        <a class="button is-light" href="../index.html"> <!-- Adjusted logout path -->
                            ƒêƒÉng xu·∫•t
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-3">
                    <aside class="menu">
                        <p class="menu-label" id="user-role">
                            Vai tr√≤: Nh√† Thu·ªëc
                        </p>
                        <p class="menu-label" id="user-name">
                            T√™n ng∆∞·ªùi d√πng
                        </p>
                        <p class="menu-label">
                            Ch·ª©c nƒÉng
                        </p>
                        <ul class="menu-list">
                             <!-- Simplified Sidebar for Pharmacy -->
                            <li><a class="tab-link is-active" data-tab="pharmacy">Qu·∫£n l√Ω nh√† thu·ªëc</a></li> <!-- Default active tab -->
                            <li><a class="tab-link" data-tab="pharmacy-out">K√™ ƒë∆°n thu·ªëc</a></li> <!-- Default active tab -->
                            <li><a class="tab-link" data-tab="medicines">Qu·∫£n l√Ω thu·ªëc (Chung)</a></li>
                            <li><a class="tab-link" data-tab="tracking">Tra c·ª©u thu·ªëc (Chung)</a></li>
                            <li><a class="tab-link" data-tab="dashboard">T·ªïng quan (Chung)</a></li> <!-- Kept dashboard for overview -->
                        </ul>
                    </aside>
                </div>
                
                <div class="column is-9">
                    <!-- Dashboard Tab (Kept for general overview) -->
                    <div class="tab-content is-hidden" id="dashboard"> <!-- Hidden by default -->
                        <h1 class="title">T·ªïng quan (Chung)</h1>
                        <!-- Content remains, might be populated by shared JS logic -->
                         <div class="columns">
                            <div class="column">
                                <div class="box has-text-centered">
                                    <p class="heading">T·ªïng s·ªë lo·∫°i thu·ªëc</p>
                                    <p class="title" id="total-medicines">...</p>
                                </div>
                            </div>
                            <div class="column">
                                <div class="box has-text-centered">
                                    <p class="heading">T·ªïng s·ªë l√¥ trong kho</p>
                                    <p class="title" id="total-batches">...</p>
                                </div>
                            </div>
                            <div class="column">
                                <div class="box has-text-centered">
                                    <p class="heading">ƒê∆°n h√†ng ch·ªù x·ª≠ l√Ω</p>
                                    <p class="title" id="total-orders">...</p>
                                </div>
                            </div>
                            <div class="column">
                                <div class="box has-text-centered">
                                    <p class="heading">Y√™u c·∫ßu nh·∫≠p thu·ªëc</p>
                                    <p class="title" id="total-prescriptions">...</p> <!-- Re-purposed for requests -->
                                </div>
                            </div>
                        </div>
                        <div class="box" id="recent-activity">
                            <h2 class="subtitle">Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y (Chung)</h2>
                            <div class="content">
                                <ul id="activity-list">
                                    <!-- Dynamic content -->
                                </ul>
                            </div>
                        </div>
                    </div>

                     <!-- Medicines Tab (Kept as potentially generic) -->
                    <div class="tab-content is-hidden" id="medicines">
                         <h1 class="title">Qu·∫£n l√Ω thu·ªëc (Th√¥ng tin chung)</h1>
                         <div class="box">
                            <h2 class="subtitle">Danh s√°ch thu·ªëc</h2>
                            <table class="table is-fullwidth is-striped is-hoverable">
                                <thead>
                                    <tr>
                                        <th>M√£ thu·ªëc</th>
                                        <th>T√™n thu·ªëc</th>
                                        <th>Lo·∫°i</th>
                                        <th>Ki·ªÉu</th>
                                        <th>B·∫£o qu·∫£n</th>
                                    </tr>
                                </thead>
                                <tbody id="medicines-list">
                                    <!-- Dynamic content -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tracking Tab (Kept as potentially generic) -->
                    <div class="tab-content is-hidden" id="tracking">
                         <h1 class="title">Tra c·ª©u thu·ªëc (Chung)</h1>
                         <div class="box">
                            <div class="field has-addons">
                                <div class="control is-expanded">
                                    <input class="input" type="text" id="track-logid-input" placeholder="Nh·∫≠p m√£ ghi nh·∫≠n (Log ID)">
                                </div>
                                <div class="control">
                                    <button class="button is-info" id="track-logid-button">Tra c·ª©u</button>
                                </div>
                            </div>
                            <div id="tracking-results" class="mt-4 is-hidden">
                                <h3 class="subtitle">Th√¥ng tin chi ti·∫øt</h3>
                                <div class="box" id="tracking-medicine-details">
                                    <!-- Medicine details populated here -->
                                </div>
                                <h3 class="subtitle mt-4">L·ªãch s·ª≠ ph√¢n ph·ªëi</h3>
                                <div class="timeline box">
                                    <ul id="tracking-history-list">
                                        <!-- History populated here -->
                                    </ul>
                                </div>
                                <div class="mt-4 has-text-centered">
                                     <canvas id="qr-code-canvas"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- REMOVED Manufacturer Tab -->
                    <!-- REMOVED Distributor Tab -->
                    
                    <!-- Pharmacy Tab -->
                    <div class="tab-content" id="pharmacy"> <!-- Default visible tab -->
                        <h1 class="title">Qu·∫£n l√Ω nh√† thu·ªëc</h1>
                        <div class="box">
                            <h2 class="subtitle">Y√™u c·∫ßu nh·∫≠p thu·ªëc t·ª´ nh√† ph√¢n ph·ªëi</h2>
                            <form id="create-request-form">
                                <div class="field">
                                    <label class="label">Ch·ªçn Nh√† ph√¢n ph·ªëi</label>
                                    <div class="control">
                                        <div class="select is-fullwidth">
                                            <select id="request-distributor">
                                                <option value="">--Ch·ªçn nh√† ph√¢n ph·ªëi--</option>
                                                <!-- Options populated by JS -->
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div id="request-items-container">
                                    <!-- Request items will be added here by JS -->
                                    <div class="request-item field is-grouped">
                                        <div class="control is-expanded">
                                            <label class="label is-small">M√£ thu·ªëc</label>
                                            <input class="input request-medicine-id" type="text" placeholder="Nh·∫≠p m√£ thu·ªëc c·∫ßn nh·∫≠p">
                                        </div>
                                        <div class="control">
                                             <label class="label is-small">S·ªë l∆∞·ª£ng</label>
                                            <input class="input request-quantity" type="number" min="1" placeholder="S·ªë l∆∞·ª£ng">
                                        </div>
                                        <div class="control">
                                            <label class="label is-small">&nbsp;</label> <!-- Spacer for alignment -->
                                            <button type="button" class="button is-danger remove-request-item" disabled>&times;</button> <!-- Disabled for the first item -->
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <div class="field is-grouped is-grouped-right">
                                    <div class="control">
                                        <button class="button is-link" type="button" id="add-request-item-button">+ Th√™m thu·ªëc</button>
                                    </div>
                                    <div class="control">
                                        <button class="button is-primary" type="button" id="create-request-button">G·ª≠i y√™u c·∫ßu nh·∫≠p thu·ªëc</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        
                        <div class="box">
                            <h2 class="subtitle">Kho thu·ªëc hi·ªán t·∫°i</h2>
                            <table class="table is-fullwidth is-striped is-hoverable">
                                <thead>
                                    <tr>
                                        <th>M√£ thu·ªëc</th>
                                        <th>T√™n thu·ªëc</th>
                                        <th>S·ªë l∆∞·ª£ng</th>
                                        <th>Gi√° c·∫£</th>
                                        <th>S·ªë ƒëi·ªán tho·∫°i ng∆∞·ªùi mua</th>
                                        <th>ƒê∆°n mua</th>
                                        <th>B√°n</th>
                                    </tr>
                                </thead>
                                <tbody id="pharmacy-inventory">
                                    <!-- Dynamic content: List of medicines in pharmacy inventory -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content is-hidden" id="pharmacy-out">
                        <h1 class="title">K√™ ƒë∆°n thu·ªëc</h1>

                        <!-- T√¨m b·ªánh nh√¢n -->
                        <div class="box">
                            <h2 class="subtitle">T√¨m b·ªánh nh√¢n</h2>
                            <div class="field has-addons">
                            <div class="control is-expanded">
                                <input id="patient-phone-input" class="input" type="text" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i b·ªánh nh√¢n">
                            </div>
                            <div class="control">
                                <button id="search-patient-btn" class="button is-primary">T√¨m</button>
                            </div>
                            </div>
                        </div>

                        <!-- Th√¥ng tin b·ªánh nh√¢n -->
                        <div id="patient-info-section" class="box is-hidden">
                            <h2 class="subtitle">Th√¥ng tin b·ªánh nh√¢n</h2>
                            <p id="patient-name">H·ªç t√™n: </p>
                            <p id="patient-phone">SƒêT: </p>
                            <p id="patient-id">M√£ b·ªánh nh√¢n: </p>
                        </div>

                        <!-- Form k√™ ƒë∆°n -->
                        <div id="medicine-request-section" class="box">
                            <h2 class="subtitle">ƒê∆°n thu·ªëc</h2>
                            <form id="prescription-form">
                            <table class="table is-fullwidth is-striped is-hoverable">
                                <thead>
                                <tr>
                                    <th>M√£ thu·ªëc</th>
                                    <th>T√™n thu·ªëc</th>
                                    <th>Gi√° (VNƒê)</th>
                                    <th>S·ªë l∆∞·ª£ng mu·ªën k√™</th>
                                    <th>X√≥a</th>
                                </tr>
                                </thead>
                                <tbody id="requested-medicine-list">
                                <!-- JS s·∫Ω t·ª± th√™m d√≤ng thu·ªëc -->
                                </tbody>
                            </table>
                            <div class="buttons">
                                <button class="button is-link" type="button" id="add-item-button">+ Th√™m thu·ªëc</button>
                                <button type="submit" class="button is-success">üíä K√™ ƒë∆°n</button>
                            </div>
                            </form>
                        </div>
                        </div>



                     <!-- Generic Medicine Tracking Modal (copied from index.html, might need adjustment in JS) -->
                    <div class="modal" id="tracking-modal-generic"> 
                        <div class="modal-background"></div>
                        <div class="modal-card">
                            <header class="modal-card-head">
                                <p class="modal-card-title">Tra c·ª©u thu·ªëc (Chung)</p>
                                <button class="delete" aria-label="close" id="close-tracking-modal-generic"></button>
                            </header>
                            <section class="modal-card-body">
                                <div class="field">
                                    <label class="label">Nh·∫≠p m√£ thu·ªëc ho·∫∑c m√£ ghi nh·∫≠n:</label>
                                    <div class="control">
                                        <input class="input" type="text" id="medicine-code-generic" placeholder="Nh·∫≠p m√£ QR, m√£ v·∫°ch, ho·∫∑c Log ID">
                                    </div>
                                </div>
                                <button class="button is-primary" id="search-medicine-generic">Tra c·ª©u</button>
                                <div id="medicine-info-generic" class="mt-4 is-hidden">
                                    <h3 class="subtitle">Th√¥ng tin thu·ªëc</h3>
                                    <div class="box">
                                        <p><strong>T√™n thu·ªëc:</strong> <span id="medicine-name-generic"></span></p>
                                        <p><strong>Nh√† s·∫£n xu·∫•t:</strong> <span id="medicine-manufacturer-generic"></span></p>
                                        <p><strong>Ng√†y s·∫£n xu·∫•t:</strong> <span id="medicine-production-date-generic"></span></p>
                                        <p><strong>H·∫°n s·ª≠ d·ª•ng:</strong> <span id="medicine-expiry-date-generic"></span></p>
                                        <p><strong>L√¥ s·∫£n xu·∫•t:</strong> <span id="medicine-batch-generic"></span></p>
                                        <p><strong>M√£ ghi nh·∫≠n:</strong> <span id="medicine-logid-generic"></span></p>
                                    </div>
                                    <h3 class="subtitle mt-4">L·ªãch s·ª≠ ph√¢n ph·ªëi</h3>
                                    <div class="timeline box">
                                        <ul id="distribution-history-generic"></ul>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>
    
    <footer class="footer">
        <div class="content has-text-centered">
            <p>
                &copy; 2025 H·ªá Th·ªëng Ph√¢n Ph·ªëi Thu·ªëc
            </p>
        </div>
    </footer>
    <!-- Link to the role-specific JS file -->
    <script type="module" src="dashboard.js"></script> 
</body>
</html>

